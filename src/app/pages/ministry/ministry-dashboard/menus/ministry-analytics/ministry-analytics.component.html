<div class="bg-white">
  <div
    class="mx-auto max-w-7xl px-4 sm:px-6 md:px-8 border-b border-gray-200 pb-5"
  >
    <h1 class="text-2xl font-semibold text-gray-900">Analytics Report</h1>
  </div>
  <div class="mx-auto max-w-7xl px-4 pb-12 pt-6 sm:px-6 lg:px-8">
    <div class="py-3">
      <!-- Dropdown to select a specific merchant -->
      <label
        class="block text-sm font-medium text-gray-700"
        for="merchantSelect"
        >Select a Merchant:
      </label>

      <select
        id="merchantSelect"
        class="mt-1 block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm"
        [(ngModel)]="selectedMerchantId"
        (change)="onSelectMerchant(selectedMerchantId)"
      >
        <option value="" disabled>Select a merchant</option>
        <option value="">All</option>
        <option
          *ngFor="let merchant of allMerchantAnalytics"
          [value]="merchant.merchant.id"
        >
          {{ merchant.merchant.name }}
        </option>
      </select>
    </div>

    <!-- Tab selection for different analytics views -->
    <div x-data="{ openTab: 1 }">
      <div class="sm:hidden">
        <label for="tabs" class="sr-only">Select a tab</label>
        <select
          id="tabs"
          name="tabs"
          x-model="openTab"
          class="block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm"
        >
          <option value="1">Product Sold</option>
          <option value="2">Purchasing Power</option>
        </select>
      </div>

      <!-- Tab navigation for larger screens -->
      <div class="hidden sm:block">
        <div class="border-b border-gray-200">
          <nav class="-mb-px flex space-x-8" aria-label="Tabs">
            <div *ngIf="!selectedMerchantId">
              <button
                (click)="showProductSoldChart()"
                x-bind:class="{ 'border-indigo-500 text-indigo-600': openTab === 1, 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': openTab !== 1 }"
                x-on:click.prevent="openTab = 1"
                class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"
              >
                Product Sold
              </button>
              <button
                (click)="showPurchasingPowerChart()"
                x-bind:class="{ 'border-indigo-500 text-indigo-600': openTab === 2, 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': openTab !== 2 }"
                x-on:click.prevent="openTab = 2"
                class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"
              >
                Purchasing Power
              </button>
            </div>

            <div *ngIf="selectedMerchantId">
              <button
                (click)="showSelectedProductSold()"
                x-bind:class="{ 'border-indigo-500 text-indigo-600': openTab === 1, 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': openTab !== 1 }"
                x-on:click.prevent="openTab = 1"
                class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"
              >
                Product Sold
              </button>
              <button
                (click)="showSelectedPurchasingPower()"
                x-bind:class="{ 'border-indigo-500 text-indigo-600': openTab === 2, 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': openTab !== 2 }"
                x-on:click.prevent="openTab = 2"
                class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"
              >
                Purchasing Power
              </button>
            </div>
          </nav>
        </div>
      </div>
    </div>

    <!-- Display analytics data for the selected merchant -->
    <div *ngIf="selectedMerchantId">
      <div *ngIf="selectedProductSold">
        <canvas id="selectedProductSoldChart"></canvas>
      </div>

      <!-- Total Spent Chart -->
      <div *ngIf="selectedPurchasingPower">
        <canvas id="selectedPurchasingPowerChart"></canvas>
      </div>
    </div>

    <!-- Display analytics data for all merchants -->
    <div *ngIf="!selectedMerchantId">
      <div *ngIf="allMerchantProductSold">
        <canvas id="allProductSoldChart"></canvas>
      </div>

      <!-- Total Spent Chart -->
      <div *ngIf="allMerchantPurchasingPower">
        <canvas id="allPurchasingPowerChart"></canvas>
      </div>
    </div>
  </div>
</div>
